<div class="filters-container">
    <mat-form-field appearance="outline" class="filter-owner">
      <mat-label>Filtrar por propietario</mat-label>
      <mat-select [(value)]="selectedOwnerId" (selectionChange)="filterTasks()">
        <mat-option [value]="null">Todos</mat-option>
        @for (user of allUsers; track user._id.id) {
          <mat-option [value]="user._id.id">{{ user._id.id.username || user._id.id }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  
    <mat-form-field appearance="outline" class="filter-label">
      <mat-label>Filtrar por etiqueta</mat-label>
      <mat-select [(value)]="selectedLabelId" (selectionChange)="filterTasks()">
        <mat-option [value]="null">Todas</mat-option>
        @for (label of allLabels; track label._id) {
          <mat-option [value]="label._id">{{ label.name }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
</div>

<div class="statuses-container">
  <!-- To Do -->
  <div class="status-container">
    <h2>To Do</h2>
    <div
      class="tasks-container"
      cdkDropList
      id="toDo"
      #toDoList="cdkDropList"
      [cdkDropListData]="filtered_toDo"
      [cdkDropListConnectedTo]="[inProcessList, underReviewList, finishedList]"
      (cdkDropListDropped)="onTaskDrop($event,'67e67c1b2d4890a08460641b')"
    >
      <div *ngFor="let task of filtered_toDo" cdkDrag>
        <app-tasks [tasks]="[task]"></app-tasks>
      </div>
    </div>
  </div>

  <!-- In Process -->
  <div class="status-container">
    <h2>In Process</h2>
    <div
      class="tasks-container"
      cdkDropList
      id="inProcess"
      #inProcessList="cdkDropList"
      [cdkDropListData]="filtered_inProcess"
      [cdkDropListConnectedTo]="[toDoList, underReviewList, finishedList]"
      (cdkDropListDropped)="onTaskDrop($event, '67e67c222d4890a08460641d')"
    >
      <div *ngFor="let task of filtered_inProcess" cdkDrag>
        <app-tasks [tasks]="[task]"></app-tasks>
      </div>
    </div>
  </div>

  <!-- Under Review -->
  <div class="status-container">
    <h2>Under Review</h2>
    <div
      class="tasks-container"
      cdkDropList
      id="underReview"
      #underReviewList="cdkDropList"
      [cdkDropListData]="filtered_underReview"
      [cdkDropListConnectedTo]="[toDoList, inProcessList, finishedList]"
      (cdkDropListDropped)="onTaskDrop($event, '67e67c2a2d4890a08460641f')"
    >
      <div *ngFor="let task of filtered_underReview" cdkDrag>
        <app-tasks [tasks]="[task]"></app-tasks>
      </div>
    </div>
  </div>

  <!-- Finished -->
  <div class="status-container">
    <h2>Finished</h2>
    <div
      class="tasks-container"
      cdkDropList
      id="finished"
      #finishedList="cdkDropList"
      [cdkDropListData]="filtered_finished"
      [cdkDropListConnectedTo]="[toDoList, inProcessList, underReviewList]"
      (cdkDropListDropped)="onTaskDrop($event, '67e67c2f2d4890a084606421')"
    >
      <div *ngFor="let task of filtered_finished" cdkDrag>
        <app-tasks [tasks]="[task]"></app-tasks>
      </div>
    </div>
  </div>
</div>


  